# We will generally lock on MINOR versions to allow for some patch wiggle room at the library 
# importer, in case some small bug fix happens in the patches
[package]
name = "atb"
version = "0.12.0"
authors = ["Denis Tsai <denistsai@aetheras.io>"]
edition = "2018"

[dependencies]
log = "0.4"
env_logger = "0.8"
ansi_term = "0.12"
uuid = { version = "0.8", features = ["serde", "v4", "v5"] }
chrono = { version = "0.4", features = ["serde"] }
thiserror = "1"
anyhow = "1"
futures = "=0.3.12"
lazy_static = "1.4"
byteorder = "1.3" 
# time = "0.2"

# HTTP 
# actix = { version = "0.10", optional = true }
# actix-web = { version = "3.3", optional = true }
# actix-web-httpauth = { version = "0.5", optional = true }
# actix-cors = { version = "0.5", optional = true }

# #HACK for tokio1 since libraries are all over the place 
actix = { version = "0.11.1", optional = true }
actix-rt = { version = "2.2", optional = true }
actix-service = { version = "=2.0.0-beta.5", optional = true }
actix-web = { version = "=4.0.0-beta.5", optional = true }
actix-http = { version = "=3.0.0-beta.5", optional = true }
actix-utils = { version = "=3.0.0-beta.4", optional = true }
actix-cors = { version = "=0.6.0-beta.1", optional = true }
actix-web-httpauth = { version = "=0.6.0-beta.1", optional = true }

# Graphql
juniper = { version = "0.15.3", optional = true }
# #HACK for tokio1 since libraries are all over the place 
# juniper_actix = { version = "0.2.2", optional = true }
dataloader = { version = "0.14.0", optional = true }

# Eventsourcing
# lucidstream = { git = "https://github.com/dt665m/lucidstream-rs.git", tag = "v0.9.2", optional = true }
# lucidstream-ges = { git = "https://github.com/dt665m/lucidstream-rs.git", tag = "v0.9.2", optional = true }
lucidstream = { path = "../../dt665m/lucidstream-rs/lucidstream", optional = true }
lucidstream-ges = { path = "../../dt665m/lucidstream-rs/lucidstream-ges", optional = true }

# Sql
sqlx = { version = "0.5.1", default-features = false, optional = true }
quaint = { git = "https://github.com/prisma/quaint", rev = "ac3d9f22875c899ef8d1c0aff7d2b0d206f0e314", optional = true } 

# Fixtures
fake = { version = "2.2", optional = true }

# JWT / Miscellaneous 
time = { version = "0.2", optional = true }
jsonwebtoken = {version = "7.2", optional = true }
serde = { version = "1", features = ["derive"], optional = true }
serde_json = { version = "1", optional = true } 
base64 = { version = "0.12", optional = true } 

# Nothing by default
[features]
default = ["all"]
all = [
  "http",
  "graphql",
  "jwt",
  "sql",
  "eventsourcing",
  "fixtures",
]
http = [
  "actix",
  "actix-web",
  "actix-web-httpauth",
  "actix-cors",
  #HACK for tokio1
	"actix-rt",
	"actix-utils",
	"actix-http",
  "actix-service",
  "time"
]
graphql = [
  "juniper/uuid",
  # "juniper_actix",
  "dataloader",
]
jwt = [
  "serde",
  "serde_json",
  "jsonwebtoken",
  "base64"
]
sql = [
  "sqlx/runtime-tokio-rustls",
  "sqlx/macros",
  "sqlx/postgres",
  "sqlx/uuid",
  "sqlx/chrono",
  "sqlx/json",
  "sqlx/bigdecimal",
  "sqlx/decimal",
  "sqlx/bit-vec",
  "quaint/postgresql",
  "quaint/serde-support",
  "quaint/json",
  "quaint/chrono",
  "quaint/uuid",
  "quaint/bigdecimal",
]
eventsourcing = [
  "lucidstream",
  "lucidstream-ges",
]
serde_utils = [
	"serde",
	"serde_json",
]
fixtures = [
  "fake/derive",
  "jsonwebtoken",
]
